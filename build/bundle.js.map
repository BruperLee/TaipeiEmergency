{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap e53e7f9a420921f81a43","webpack:///./src/index.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","initMap","map","google","maps","Map","document","querySelector","center","lat","lng","zoom","createMap","filterData","parseFloat","Wgs84Y","Wgs84X","initMarker","address","CaseLocationDescription","name","PName","caseID","CaseID","marker","Marker","position","title","markerList","push","event","addListener","showInfo","this","setAreaList","dataList","forEach","value","areaList","indexOf","CaseLocationDistrict","createAreaSelect","areaOptions","concat","item","join","contentSelect","innerHTML","selectArea","selectedOptions","text","filter","data","creatTable","table","CaseTime","CaseDescription","tbody","infoTrs","querySelectorAll","infoTr","addEventListener","handleInfoTrClicked","e","currentTarget","getAttribute","markerObj","infowindow","setContent","infoContent","open","dataUrl","InfoWindow","fetch","method","then","response","ok","Error","statusText","json","promiseValue","caseList","DataSet","NewDataSet","CASE_SUMMARY","apply","catch","error"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAE,WACAE,GAAAJ,EACAK,QAAA,EAUA,OANAP,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,QAAA,EAGAF,EAAAD,QAvBA,GAAAD,KAqCA,OATAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAU,EAAA,GAGAV,EAAA,KDMM,SAAUI,EAAQD,EAASH,GAEhCI,EAAOD,QAAUH,EAAoB,IAKhC,SAAUI,EAAQD,GAEvB,YAEA,SAASQ,GAAmBC,GAAO,GAAIC,MAAMC,QAAQF,GAAM,CAAE,IAAK,GAAIG,GAAI,EAAGC,EAAOH,MAAMD,EAAIK,QAASF,EAAIH,EAAIK,OAAQF,IAAOC,EAAKD,GAAKH,EAAIG,EAAM,OAAOC,GAAe,MAAOH,OAAMK,KAAKN,GE1C3L,QAASO,KACLC,EAAM,GAAIC,QAAOC,KAAKC,IAAIC,SAASC,cAAc,SAC7CC,QAAUC,IAAK,UAAWC,IAAK,YAC/BC,KAAM,KAId,QAASC,KACqB,IAAtBC,EAAWd,SAIfG,EAAM,GAAIC,QAAOC,KAAKC,IAClBC,SAASC,cAAc,SAEnBC,QAAUC,IAAKK,WAAWD,EAAW,GAAGE,QAASL,IAAKI,WAAWD,EAAW,GAAGG,SAC/EL,KAAM,MAKlB,QAASM,KACL,IAAK,GAAIpB,GAAI,EAAGA,EAAIgB,EAAWd,OAAQF,IAAK,CACxC,GAAMqB,GAAUL,EAAWhB,GAAGsB,wBACxBC,EAAOP,EAAWhB,GAAGwB,MACrBC,EAAST,EAAWhB,GAAG0B,OAEvBC,EAAS,GAAIrB,QAAOC,KAAKqB,QAC3BC,UAAYjB,IAAKK,WAAWD,EAAWhB,GAAGkB,QAASL,IAAKI,WAAWD,EAAWhB,GAAGmB,SACjFd,IAAKA,EACLyB,MAAOP,EAAMF,UAASI,UAG1BM,GAAWC,KAAKL,GAEhBrB,OAAOC,KAAK0B,MAAMC,YAAYP,EAAQ,QAAS,WAC3CQ,EAASC,SAKrB,QAASC,KACLC,EAASC,QAAQ,SAAAC,GACTC,EAASC,QAAQF,EAAMG,yBAA0B,GACjDF,EAAST,KAAKQ,EAAMG,wBAKhC,QAASC,KACL,GAAIC,yHAKJA,GAAcA,EAAYC,OAAOL,EAASpC,IAAI,SAAA0C,GAAA,wBAA2BA,EAA3B,KAAoCA,EAApC,cAAsDC,KAAK,KAEzGC,EAAcC,UAAYL,EAG9B,QAASM,KAEDnC,EAD0C,WAA1CiC,EAAcG,gBAAgB,GAAGC,KACpBf,EAEAA,EAASgB,OAAO,SAAAC,GAAA,MAASA,GAAKZ,uBAAyBM,EAAcG,gBAAgB,GAAGC,OAG/E,IAAtBrC,EAAWd,SAIfa,IACAK,IACAoC,KAGJ,QAASA,KACL,GAA0B,IAAtBxC,EAAWd,OAAf,CAIA,GAAIuD,KAEJzC,GAAWuB,QAAQ,SAAAC,GACfiB,EAAMzB,KAAN,yCAC8BQ,EAAMd,OADpC,uBAEUc,EAAMkB,SAFhB,0BAGUlB,EAAMG,qBAHhB,0BAIUH,EAAMlB,wBAJhB,0BAKUkB,EAAMmB,gBALhB,oCAUJC,EAAMV,UAAYO,EAAMT,KAAK,GAE7B,IAAMa,GAAUpD,SAASqD,iBAAiB,WAC1CD,GAAQtB,QAAQ,SAAAwB,GAAA,MAAUA,GAAOC,iBAAiB,QAASC,MAG/D,QAASA,GAAqBC,GAC1B,GAAMvC,GAASI,EAAWuB,OAAO,SAAAd,GAAA,MAAUA,GAAMf,SAAYyC,EAAEC,cAAcC,aAAa,WAE1FjC,GAASR,EAAO,IAGpB,QAASQ,GAAUkC,GACfC,EAAWC,WAAWC,EAAYH,IAElCC,EAAWG,KAAKpE,EAAKgE,GAGzB,QAASG,GAAYH,GACjB,iBAAmBA,EAAU5C,OAA7B,wDACsB4C,EAAUvC,MADhC,oCAEwBuC,EAAUhD,QAFlC,yCA5HJ,GAAMqD,GAAU,wEACVpC,KACAP,KACAU,KACFzB,KACAX,SAEE4C,EAAgBxC,SAASC,cAAc,gBACvCkD,EAAQnD,SAASC,cAAc,UAC/B4D,EAAa,GAAIhE,QAAOC,KAAKoE,UA0HnCC,OAAMF,GAAWG,OAAQ,QACtBC,KAAK,SAAAC,GAEJ,IAAKA,EAASC,GAEZ,KAAM,IAAIC,OAAMF,EAASG,WAE3B,OAAOH,GAASI,SAEjBL,KAAK,SAAAM,GACJ,GAAMC,GAAWD,EAAaE,QAAQ,mBAAmBC,WAAWC,YACpElD,GAASN,KAATyD,MAAAnD,EAAA1C,EAAiByF,IACjBhD,IACAO,MAED8C,MAAM,SAAAC,MAKT1C,EAAce,iBAAiB,SAAUb,GACzC/C","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(1);\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tvar dataUrl = 'https://tcgbusfs.blob.core.windows.net/blobfs/GetDisasterSummary.json';\n\tvar dataList = [];\n\tvar markerList = [];\n\tvar areaList = [];\n\tvar filterData = [];\n\tvar map = void 0;\n\t\n\tvar contentSelect = document.querySelector('.select-area');\n\tvar tbody = document.querySelector('.tbody');\n\tvar infowindow = new google.maps.InfoWindow();\n\t\n\tfunction initMap() {\n\t    map = new google.maps.Map(document.querySelector('.map'), {\n\t        center: { lat: 25.050592, lng: 121.539384 },\n\t        zoom: 12\n\t    });\n\t}\n\t\n\tfunction createMap() {\n\t    if (filterData.length === 0) {\n\t        return;\n\t    }\n\t\n\t    map = new google.maps.Map(document.querySelector('.map'), {\n\t        center: { lat: parseFloat(filterData[0].Wgs84Y), lng: parseFloat(filterData[0].Wgs84X) },\n\t        zoom: 14\n\t    });\n\t}\n\t\n\tfunction initMarker() {\n\t    for (var i = 0; i < filterData.length; i++) {\n\t        var address = filterData[i].CaseLocationDescription;\n\t        var name = filterData[i].PName;\n\t        var caseID = filterData[i].CaseID;\n\t\n\t        var marker = new google.maps.Marker({\n\t            position: { lat: parseFloat(filterData[i].Wgs84Y), lng: parseFloat(filterData[i].Wgs84X) },\n\t            map: map,\n\t            title: name, address: address, caseID: caseID\n\t        });\n\t\n\t        markerList.push(marker);\n\t\n\t        google.maps.event.addListener(marker, 'click', function () {\n\t            showInfo(this);\n\t        });\n\t    }\n\t}\n\t\n\tfunction setAreaList() {\n\t    dataList.forEach(function (value) {\n\t        if (areaList.indexOf(value.CaseLocationDistrict) === -1) {\n\t            areaList.push(value.CaseLocationDistrict);\n\t        }\n\t    });\n\t}\n\t\n\tfunction createAreaSelect() {\n\t    var areaOptions = '\\n        <option value=\"\" disabled selected>-- \\u8ACB\\u9078\\u64C7\\u884C\\u653F\\u5340 --</option>\\n        <option value=\"\\u5168\\u5340\">\\u5168\\u5340\\u6700\\u65B0\\u52D5\\u614B</option>\\n    ';\n\t\n\t    areaOptions = areaOptions.concat(areaList.map(function (item) {\n\t        return '<option value=\"' + item + '\">' + item + '</option>';\n\t    }).join(''));\n\t\n\t    contentSelect.innerHTML = areaOptions;\n\t}\n\t\n\tfunction selectArea() {\n\t    if (contentSelect.selectedOptions[0].text === '全區最新動態') {\n\t        filterData = dataList;\n\t    } else {\n\t        filterData = dataList.filter(function (data) {\n\t            return data.CaseLocationDistrict === contentSelect.selectedOptions[0].text;\n\t        });\n\t    }\n\t\n\t    if (filterData.length === 0) {\n\t        return;\n\t    }\n\t\n\t    createMap();\n\t    initMarker();\n\t    creatTable();\n\t}\n\t\n\tfunction creatTable() {\n\t    if (filterData.length === 0) {\n\t        return;\n\t    }\n\t\n\t    var table = [];\n\t\n\t    filterData.forEach(function (value) {\n\t        table.push('\\n        <tr class=\"info-tr\" caseID=\"' + value.CaseID + '\">\\n            <td>' + value.CaseTime + '</td>\\n            <td>' + value.CaseLocationDistrict + '</td>\\n            <td>' + value.CaseLocationDescription + '</td>\\n            <td>' + value.CaseDescription + '</td>\\n        </tr>\\n        ');\n\t    });\n\t\n\t    tbody.innerHTML = table.join('');\n\t\n\t    var infoTrs = document.querySelectorAll('.info-tr');\n\t    infoTrs.forEach(function (infoTr) {\n\t        return infoTr.addEventListener('click', handleInfoTrClicked);\n\t    });\n\t}\n\t\n\tfunction handleInfoTrClicked(e) {\n\t    var marker = markerList.filter(function (value) {\n\t        return value.caseID === e.currentTarget.getAttribute('caseID');\n\t    });\n\t\n\t    showInfo(marker[0]);\n\t}\n\t\n\tfunction showInfo(markerObj) {\n\t    infowindow.setContent(infoContent(markerObj));\n\t\n\t    infowindow.open(map, markerObj);\n\t}\n\t\n\tfunction infoContent(markerObj) {\n\t    return '<ul id=\"' + markerObj.caseID + '\" style=\"list-style:none;\">\\n                <li>\\u540D\\u7A31: ' + markerObj.title + '</li>\\n                <li>\\u8A73\\u7D30\\u4F4D\\u7F6E: ' + markerObj.address + '</li>\\n            </ul>\\n            ';\n\t}\n\t\n\tfetch(dataUrl, { method: 'GET' }).then(function (response) {\n\t    // ok 代表狀態碼在範圍 200 ~ 299\n\t    if (!response.ok) {\n\t        // showNetworkErrorMessage();\n\t        throw new Error(response.statusText);\n\t    }\n\t    return response.json();\n\t}).then(function (promiseValue) {\n\t    var caseList = promiseValue.DataSet['diffgr:diffgram'].NewDataSet.CASE_SUMMARY;\n\t    dataList.push.apply(dataList, _toConsumableArray(caseList));\n\t    setAreaList();\n\t    createAreaSelect();\n\t}).catch(function (error) {});\n\t\n\tcontentSelect.addEventListener('change', selectArea);\n\tinitMap();\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e53e7f9a420921f81a43","// @flow\n\nconst dataUrl = 'https://tcgbusfs.blob.core.windows.net/blobfs/GetDisasterSummary.json';\nconst dataList = [];\nconst markerList = [];\nconst areaList = [];\nlet filterData = [];\nlet map;\n\nconst contentSelect = document.querySelector('.select-area');\nconst tbody = document.querySelector('.tbody');\nconst infowindow = new google.maps.InfoWindow();\n\nfunction initMap() {\n    map = new google.maps.Map(document.querySelector('.map'), {\n        center: { lat: 25.050592, lng: 121.539384 },\n        zoom: 12\n    });\n}\n\nfunction createMap() {\n    if (filterData.length === 0) {\n        return;\n    }\n\n    map = new google.maps.Map(\n        document.querySelector('.map'),\n        {\n            center: { lat: parseFloat(filterData[0].Wgs84Y), lng: parseFloat(filterData[0].Wgs84X) },\n            zoom: 14,\n        }\n    );\n}\n\nfunction initMarker() {\n    for (var i = 0; i < filterData.length; i++) {\n        const address = filterData[i].CaseLocationDescription;\n        const name = filterData[i].PName;\n        const caseID = filterData[i].CaseID;\n\n        const marker = new google.maps.Marker({\n            position: { lat: parseFloat(filterData[i].Wgs84Y), lng: parseFloat(filterData[i].Wgs84X) },\n            map: map,\n            title: name, address, caseID\n        });\n\n        markerList.push(marker);\n\n        google.maps.event.addListener(marker, 'click', function() { \n            showInfo(this);\n        });\n    }\n}\n\nfunction setAreaList() {\n    dataList.forEach(value => {\n        if (areaList.indexOf(value.CaseLocationDistrict) === -1) {\n            areaList.push(value.CaseLocationDistrict);\n        }\n    });\n}\n\nfunction createAreaSelect () {\n    let areaOptions = `\n        <option value=\"\" disabled selected>-- 請選擇行政區 --</option>\n        <option value=\"全區\">全區最新動態</option>\n    `;\n    \n    areaOptions = areaOptions.concat(areaList.map(item => (`<option value=\"${item}\">${item}</option>`)).join(''));\n\n    contentSelect.innerHTML = areaOptions;\n}\n\nfunction selectArea() {\n    if (contentSelect.selectedOptions[0].text === '全區最新動態') {\n        filterData = dataList;\n    } else {\n        filterData = dataList.filter(data => (data.CaseLocationDistrict === contentSelect.selectedOptions[0].text));\n    }\n\n    if (filterData.length === 0) {\n        return;\n    }\n\n    createMap();\n    initMarker();\n    creatTable();\n}\n\nfunction creatTable () {\n    if (filterData.length === 0) {\n        return;\n    }\n\n    let table = [];\n\n    filterData.forEach(value => {\n        table.push(`\n        <tr class=\"info-tr\" caseID=\"${value.CaseID}\">\n            <td>${value.CaseTime}</td>\n            <td>${value.CaseLocationDistrict}</td>\n            <td>${value.CaseLocationDescription}</td>\n            <td>${value.CaseDescription}</td>\n        </tr>\n        `);\n    });\n\n    tbody.innerHTML = table.join('');\n\n    const infoTrs = document.querySelectorAll('.info-tr');\n    infoTrs.forEach(infoTr => infoTr.addEventListener('click', handleInfoTrClicked));\n}\n\nfunction handleInfoTrClicked (e) {\n    const marker = markerList.filter(value => (value.caseID) === e.currentTarget.getAttribute('caseID'));\n\n    showInfo(marker[0]);\n}\n\nfunction showInfo (markerObj) {\n    infowindow.setContent(infoContent(markerObj));\n    \n    infowindow.open(map, markerObj);\n}\n\nfunction infoContent(markerObj) {\n    return (`<ul id=\"${markerObj.caseID}\" style=\"list-style:none;\">\n                <li>名稱: ${markerObj.title}</li>\n                <li>詳細位置: ${markerObj.address}</li>\n            </ul>\n            `);\n}\n\nfetch(dataUrl, { method: 'GET' })\n  .then(response => {\n    // ok 代表狀態碼在範圍 200 ~ 299\n    if (!response.ok) {\n      // showNetworkErrorMessage();\n      throw new Error(response.statusText);\n    }\n    return response.json();\n  })\n  .then(promiseValue => {\n    const caseList = promiseValue.DataSet['diffgr:diffgram'].NewDataSet.CASE_SUMMARY;\n    dataList.push(...caseList);\n    setAreaList();\n    createAreaSelect();\n  })\n  .catch(error => {\n\n }\n);\n\ncontentSelect.addEventListener('change', selectArea);\ninitMap();\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}